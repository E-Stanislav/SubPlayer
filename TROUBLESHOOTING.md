# Решение проблем

## Предупреждение о конфликте libavdevice

Если вы видите предупреждение:
```
objc[...]: Class AVFFrameReceiver is implemented in both ...
```

**Это не критическая ошибка!** Приложение должно работать нормально.

### Что это значит?

Это конфликт версий библиотеки `libavdevice`:
- Системная версия из Homebrew (ffmpeg)
- Версия из пакета `av` (PyAV, зависимость faster-whisper)

### Решения

#### Вариант 1: Игнорировать (рекомендуется)
Предупреждение можно игнорировать, если приложение работает нормально.

#### Вариант 2: Использовать системный ffmpeg
Если возникают проблемы, можно настроить использование системного ffmpeg:

```bash
# Убедитесь, что системный ffmpeg в PATH
which ffmpeg
```

#### Вариант 3: Обновить зависимости
```bash
source venv/bin/activate
pip install --upgrade av faster-whisper
```

#### Вариант 4: Подавить предупреждение
Предупреждение уже подавлено в скрипте `run.sh` через переменную окружения.

## Другие проблемы

### Приложение не запускается

1. Проверьте, что виртуальное окружение активировано:
   ```bash
   source venv/bin/activate
   ```

2. Проверьте установку зависимостей:
   ```bash
   pip list | grep -E "(PySide6|faster-whisper|argostranslate)"
   ```

3. Запустите с выводом ошибок:
   ```bash
   python -m subplayer.app 2>&1 | tee error.log
   ```

### Ошибки при генерации субтитров

1. **ffmpeg не найден:**
   ```bash
   # macOS
   brew install ffmpeg
   
   # Linux
   sudo apt install ffmpeg
   ```

2. **Модель не скачивается:**
   - Проверьте подключение к интернету
   - Модели скачиваются автоматически при первом использовании
   - Проверьте свободное место на диске (~500MB для модели base)

### Ошибки при переводе

1. **Языковой пакет не установлен:**
   - При первом переводе Argos Translate скачает нужный пакет
   - Требуется подключение к интернету

2. **Перевод не работает:**
   - Проверьте, что исходный язык определен правильно
   - Попробуйте указать язык вручную в настройках

### Проблемы с mpv

1. **Видео не воспроизводится:**
   ```bash
   # macOS
   brew install mpv
   
   # Linux
   sudo apt install mpv
   ```

2. **mpv не найден:**
   - python-mpv может работать без системного mpv
   - Но для лучшей совместимости установите системный mpv

## Логи и отладка

Для получения подробных логов:

```bash
# Запуск с выводом всех сообщений
python -m subplayer.app --verbose

# Или через Python
python -c "import logging; logging.basicConfig(level=logging.DEBUG); from subplayer.app import main; main()"
```

